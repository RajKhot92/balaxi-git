<div class="page-wrapper">
    <div class="page-breadcrumb">
        <div class="row">
            <div class="col-12 d-flex no-block align-items-center">
                <h4 class="page-title">Product Details</h4>
                <div class="ms-auto text-end">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="#">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">
                            Product Details
                            </li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <input type="hidden" id="login_id" name="login_id">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12">
                                <table class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th><b>Product Name</b></th>
                                            <th><b>Product Owner</b></th>
                                            <th><b>Product Category</b></th>
                                            <th><b>Product Country</b></th>
                                            <th><b>Overall Progess</b></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td id="tdProductName"></td>
                                            <td id="tdProductOwner"></td>
                                            <td id="tdProductCategory"></td>
                                            <td id="tdProductCountry"></td>
                                            <td id="tdOverallProgress" class="text-center"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3" style="cursor: pointer;" onclick="loadSubPageContent('menu-data-capture-view.html')">
                                <div class="card card-hover">
                                    <div class="box bg-cyan text-center">
                                        <h3 class="font-light text-white">
                                            <i class="fas fa-keyboard"></i>
                                        </h3>
                                        <h6 class="text-white">Technical Draft</h6>
                                        <hr class="text-white">
                                        <span class="text-white" id="spnTechnicalDraft"></span>
                                        <br/>
                                        <span style="display: none;" class="text-white" id="spnTechnicalDraftUser"></span>
                                        <span class="text-white" id="spnTechnicalDraftUserName"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card card-hover">
                                    <div class="box bg-success text-center">
                                        <h3 class="font-light text-white">
                                            <i class="fas fa-handshake"></i>
                                        </h3>
                                        <h6 class="text-white">Vendor Finalization</h6>
                                        <hr class="text-white">
                                        <span class="text-white" id="spnVendorFinalization"></span>
                                        <br/>
                                        <span style="display: none;" class="text-white" id="spnVendorFinalizationUser"></span>
                                        <span class="text-white" id="spnVendorFinalizationUserName"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card card-hover">
                                    <div class="box bg-warning text-center">
                                        <h3 class="font-light text-white">
                                            <i class="fas fa-book"></i>
                                        </h3>
                                        <h6 class="text-white">Document & Sample Collection</h6>
                                        <hr class="text-white">
                                        <span class="text-white" id="spnDocumentSampleCollection"></span>
                                        <br/>
                                        <span style="display: none;" class="text-white" id="spnDocumentSampleCollectionUser"></span>
                                        <span class="text-white" id="spnDocumentSampleCollectionUserName"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card card-hover">
                                    <div class="box bg-danger text-center">
                                        <h3 class="font-light text-white">
                                            <i class="fas fa-clipboard-check"></i>
                                        </h3>
                                        <h6 class="text-white">Sample Finalization</h6>
                                        <hr class="text-white">
                                        <span class="text-white" id="spnSampleFinalization"></span>
                                        <br/>
                                        <span style="display: none;" class="text-white" id="spnSampleFinalizationUser"></span>
                                        <span class="text-white" id="spnSampleFinalizationUserName"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card card-hover">
                                    <div class="box bg-info text-center">
                                        <h3 class="font-light text-white">
                                            <i class="fas fa-edit"></i>
                                        </h3>
                                        <h6 class="text-white">Dossier Development</h6>
                                        <hr class="text-white">
                                        <span class="text-white" id="spnDossierDevelopment"></span>
                                        <br/>
                                        <span style="display: none;" class="text-white" id="spnDossierDevelopmentUser"></span>
                                        <span class="text-white" id="spnDossierDevelopmentUserName"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card card-hover">
                                    <div class="box bg-cyan text-center">
                                        <h3 class="font-light text-white">
                                            <i class="fas fa-truck"></i>
                                        </h3>
                                        <h6 class="text-white">Shipment</h6>
                                        <hr class="text-white">
                                        <span class="text-white" id="spnShipment"></span>
                                        <br/>
                                        <span style="display: none;" class="text-white" id="spnShipmentUser"></span>
                                        <span class="text-white" id="spnShipmentUserName"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card card-hover">
                                    <div class="box bg-success text-center">
                                        <h3 class="font-light text-white">
                                            <i class="fas fa-check"></i>
                                        </h3>
                                        <h6 class="text-white">Submission</h6>
                                        <hr class="text-white">
                                        <span class="text-white" id="spnSubmission"></span>
                                        <br/>
                                        <span style="display: none;" class="text-white" id="spnSubmissionUser"></span>
                                        <span class="text-white" id="spnSubmissionUserName"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="border-top">
                            <div class="card-body text-center">
                                <button type="button" onclick="back()" id="btnBack" name="btnBack" class="btn btn-dark">
                                    <i class="fas fa-arrow-circle-left"></i>&nbsp;Back
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function(){
        $("#tdProductName").html(sessionStorage.getItem("details_product_name"));
        $("#tdProductOwner").html(sessionStorage.getItem("details_product_owner"));
        $("#tdProductCategory").html(sessionStorage.getItem("details_product_category"));
        $("#tdProductCountry").html(sessionStorage.getItem("details_product_country"));
        $("#tdOverallProgress").html("<h5>"+sessionStorage.getItem("overall_progress")+"</h5>");

        var technicalDraftUserName = sessionStorage.getItem("data_capture_assigned_name") == "" ? "Not Assigned" : sessionStorage.getItem("data_capture_assigned_name");
        $("#spnTechnicalDraft").html("<b>"+sessionStorage.getItem("data_capture")+"%</b>");
        $("#spnTechnicalDraftUser").html(sessionStorage.getItem("data_capture_assigned_to"));
        $("#spnTechnicalDraftUserName").html(technicalDraftUserName);

        var vendorFinalizationUserName = sessionStorage.getItem("vendor_finalization_assigned_name") == "" ? "Not Assigned" : sessionStorage.getItem("vendor_finalization_assigned_name");
        $("#spnVendorFinalization").html("<b>"+sessionStorage.getItem("vendor_finalization")+"%</b>");
        $("#spnVendorFinalizationUser").html(sessionStorage.getItem("vendor_finalization_assigned_to"));
        $("#spnVendorFinalizationUserName").html(vendorFinalizationUserName);

        var documentSampleCollectionUserName = sessionStorage.getItem("document_sample_collection_assigned_name") == "" ? "Not Assigned" : sessionStorage.getItem("document_sample_collection_assigned_name");
        $("#spnDocumentSampleCollection").html("<b>"+sessionStorage.getItem("document_sample_collection")+"%</b>");
        $("#spnDocumentSampleCollectionUser").html(sessionStorage.getItem("document_sample_collection_assigned_to"));
        $("#spnDocumentSampleCollectionUserName").html(documentSampleCollectionUserName);

        var sampleFinalizationUserName = sessionStorage.getItem("sample_finalization_assigned_name") == "" ? "Not Assigned" : sessionStorage.getItem("sample_finalization_assigned_name");
        $("#spnSampleFinalization").html("<b>"+sessionStorage.getItem("sample_finalization")+"%</b>");
        $("#spnSampleFinalizationUser").html(sessionStorage.getItem("sample_finalization_assigned_to"));
        $("#spnSampleFinalizationUserName").html(sampleFinalizationUserName);

        var dossierDevelopmentUserName = sessionStorage.getItem("dossier_development_assigned_name") == "" ? "Not Assigned" : sessionStorage.getItem("dossier_development_assigned_name");
        $("#spnDossierDevelopment").html("<b>"+sessionStorage.getItem("dossier_development")+"%</b>");
        $("#spnDossierDevelopmentUser").html(sessionStorage.getItem("dossier_development_assigned_to"));
        $("#spnDossierDevelopmentUserName").html(dossierDevelopmentUserName);

        var shipmentUserName = sessionStorage.getItem("shipment_assigned_name") == "" ? "Not Assigned" : sessionStorage.getItem("shipment_assigned_name");
        $("#spnShipment").html("<b>"+sessionStorage.getItem("shipment")+"%</b>");
        $("#spnShipmentUser").html(sessionStorage.getItem("shipment_assigned_to"));
        $("#spnShipmentUserName").html(shipmentUserName);

        var submissionUserName = sessionStorage.getItem("submission_assigned_name") == "" ? "Not Assigned" : sessionStorage.getItem("submission_assigned_name");
        $("#spnSubmission").html("<b>"+sessionStorage.getItem("submission")+"%</b>");
        $("#spnSubmissionUser").html(sessionStorage.getItem("submission_assigned_to"));
        $("#spnSubmissionUserName").html(submissionUserName);
    });

    function resetProduct() {
        $("#product_id").val("");
    }

    function next(){
        let productProgressResult = getProductProgress();
        // console.log(productProgressResult);
        jsonProductProgressData = JSON.parse(productProgressResult);
        // console.log(jsonProductProgressData);
        if(jsonProductProgressData.length > 0){
            for(i=0; i<jsonProductProgressData.length; i++){
                var counter = jsonProductProgressData[i];
                // console.log(counter.artwork);
                // console.log(counter.finalization);
                // console.log(counter.sample_finalization);
                $("#tdOverallProgress").html("<h5>"+counter.sample_finalization.toFixed(2)+"%</h5>");

                $("#divArtwork").html("<h4>"+counter.artwork.toFixed(2)+"%</h4>"+
                                        "<div class=\"progress\" style=\"height: 20px;\">"+
                                            "<div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\""+counter.artwork+"\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:"+counter.artwork+"%;\">"+
                                            "</div>"+
                                        "</div>");

                $("#divFinalization").html("<h4>"+counter.finalization.toFixed(2)+"%</h4>"+
                                        "<div class=\"progress\" style=\"height: 20px;\">"+
                                            "<div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\""+counter.finalization+"\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:"+counter.finalization+"%;\">"+
                                            "</div>"+
                                        "</div>");

                sessionStorage.setItem("artwork_question",counter.artwork_question);
                sessionStorage.setItem("artwork_form",counter.artwork_form);
                sessionStorage.setItem("commercial_doc",counter.commercial_doc);
                sessionStorage.setItem("artwork_finalize",counter.artwork_finalize);
            }
        }

        sessionStorage.setItem("sample_finalization_product_id",$("#product_id").val());

        $(".choose-product").hide();
        $(".selected-product").slideDown();
    }

    function getProductProgress() {
        return callAPIService("get_sample_finalization_stats.php","user_id="+localStorage.getItem("balaxi_user_id")+"&product_id="+$("#product_id").val()+"&menu_id="+currentMenuId);
    }

    function back() {
        loadPageContent(19,"product-assign-view.html");
    }
</script>